<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form CV Siswa SMA</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50, #34495e);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .form-container {
            padding: 40px;
        }

        .section {
            margin-bottom: 35px;
            border-left: 4px solid #3498db;
            padding-left: 20px;
        }

        .section.important {
            border-left-color: #e74c3c;
            background: #fff5f5;
            padding: 20px;
            border-radius: 10px;
            margin-left: -20px;
            box-shadow: 0 2px 10px rgba(231, 76, 60, 0.1);
        }

        .section h2 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.4em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .important h2 {
            color: #e74c3c;
            font-weight: 700;
        }

        .priority-badge {
            background: #e74c3c;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.7em;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .required {
            color: #e74c3c;
        }

        input[type="text"], 
        input[type="email"], 
        input[type="tel"], 
        input[type="date"],
        textarea, 
        select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        input:focus, 
        textarea:focus, 
        select:focus {
            border-color: #3498db;
            background: white;
            outline: none;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.2);
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .skill-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            margin-bottom: 15px;
        }

        .skill-item input, .skill-item select, .skill-item textarea {
            margin-bottom: 10px;
        }

        .tips {
            background: #e8f6fd;
            border: 1px solid #bee5eb;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-size: 14px;
            color: #0c5460;
        }

        .tips h4 {
            margin-bottom: 8px;
            color: #155724;
        }

        .btn-container {
            text-align: center;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 2px solid #eee;
        }

        .btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 25px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .icon {
            font-size: 1.2em;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .container {
                margin: 10px;
            }
            
            .form-container {
                padding: 20px;
            }
        }

        .highlight-box {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border: 2px solid #f39c12;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .highlight-box h3 {
            color: #d68910;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìã Form CV Siswa SMA</h1>
            <p>Lengkapi data diri untuk membuat CV yang menarik dan profesional</p>
        </div>

        <div class="form-container">
            <!-- BAGIAN PENTING: Nama & About Me -->
            <div class="section important">
                <h2><span class="icon">‚≠ê</span> Data Utama <span class="priority-badge">Wajib</span></h2>
                
                <div class="form-group">
                    <label for="nama">Nama Lengkap <span class="required">*</span></label>
                    <input type="text" id="nama" name="nama" placeholder="Contoh: Aditya Pratama Wijaya" required>
                </div>

                <div class="form-group">
                    <label for="about">About Me - Deskripsi Singkat <span class="required">*</span></label>
                    <textarea id="about" name="about" placeholder="Ceritakan tentang diri Anda dalam 2-3 kalimat. Fokus pada minat, cita-cita, dan yang membuat Anda unik sebagai siswa SMA..." required></textarea>
                    
                    <div class="tips">
                        <h4>üí° Tips About Me:</h4>
                        ‚Ä¢ Tulis 2-3 kalimat yang menggambarkan karakter dan minat Anda<br>
                        ‚Ä¢ Sebutkan cita-cita atau bidang yang diminati<br>
                        ‚Ä¢ Tunjukkan antusiasme belajar dan berkembang
                    </div>
                </div>
            </div>

            <!-- Informasi Kontak -->
            <div class="section">
                <h2><span class="icon">üìû</span> Informasi Kontak</h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="email">Email <span class="required">*</span></label>
                        <input type="email" id="email" name="email" placeholder="nama.anda@gmail.com" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">No. HP/WhatsApp</label>
                        <input type="tel" id="phone" name="phone" placeholder="0812-3456-7890">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="kota">Kota/Kabupaten</label>
                        <input type="text" id="kota" name="kota" placeholder="Contoh: Yogyakarta">
                    </div>
                    <div class="form-group">
                        <label for="sekolah">Nama Sekolah</label>
                        <input type="text" id="sekolah" name="sekolah" placeholder="Contoh: SMA Negeri 1 Yogyakarta">
                    </div>
                </div>
            </div>

            <!-- BAGIAN PENTING: Pengalaman Organisasi -->
            <div class="section important">
                <h2><span class="icon">üèÜ</span> Pengalaman Organisasi <span class="priority-badge">Penting</span></h2>
                
                <div class="highlight-box">
                    <h3>üåü Bagian Ini Sangat Penting!</h3>
                    <p>Pengalaman organisasi menunjukkan kemampuan kepemimpinan dan kerja tim Anda</p>
                </div>

                <div id="organisasi-container">
                    <div class="skill-item">
                        <label>Nama Organisasi/Ekstrakurikuler:</label>
                        <input type="text" placeholder="Contoh: OSIS, PMR, Pramuka, Rohis, dll">
                        <label>Posisi/Jabatan:</label>
                        <input type="text" placeholder="Contoh: Sekretaris, Anggota, Ketua Seksi, dll">
                        <label>Periode:</label>
                        <input type="text" placeholder="Contoh: 2023 - Sekarang">
                        <label>Deskripsi Kegiatan:</label>
                        <textarea placeholder="Jelaskan tugas dan pencapaian Anda..." rows="3"></textarea>
                    </div>
                </div>
                <button type="button" onclick="addOrganisasi()" style="background: #27ae60; color: white; padding: 10px 20px; border: none; border-radius: 5px; margin-top: 10px;">+ Tambah Organisasi</button>
                
                <div class="tips">
                    <h4>üí° Tips Pengalaman Organisasi:</h4>
                    ‚Ä¢ Sebutkan semua organisasi yang pernah diikuti (OSIS, ekstrakurikuler, volunteer)<br>
                    ‚Ä¢ Jelaskan peran dan kontribusi nyata yang telah dilakukan<br>
                    ‚Ä¢ Sertakan pencapaian atau project yang berhasil diselesaikan
                </div>
            </div>

            <!-- Skill Teknis -->
            <div class="section">
                <h2><span class="icon">üíª</span> Skill Teknis</h2>
                
                <div id="skill-teknis-container">
                    <div class="skill-item">
                        <label>Nama Skill Teknis:</label>
                        <input type="text" placeholder="Contoh: Microsoft Office, Photoshop, Python, dll">
                        <label>Tingkat Kemampuan:</label>
                        <select>
                            <option value="">Pilih tingkat kemampuan</option>
                            <option value="Dasar">Dasar</option>
                            <option value="Menengah">Menengah</option>
                            <option value="Mahir">Mahir</option>
                            <option value="Expert">Expert</option>
                        </select>
                        <label>Deskripsi/Pengalaman:</label>
                        <textarea placeholder="Jelaskan pengalaman menggunakan skill ini..." rows="2"></textarea>
                    </div>
                </div>
                <button type="button" onclick="addSkillTeknis()" style="background: #3498db; color: white; padding: 10px 20px; border: none; border-radius: 5px; margin-top: 10px;">+ Tambah Skill Teknis</button>
                
                <div class="tips">
                    <h4>üí° Contoh Skill Teknis untuk Siswa SMA:</h4>
                    ‚Ä¢ Microsoft Office (Word, Excel, PowerPoint)<br>
                    ‚Ä¢ Canva, Adobe Photoshop, Figma<br>
                    ‚Ä¢ Bahasa pemrograman (Python, HTML, CSS, JavaScript)<br>
                    ‚Ä¢ Video editing (Filmora, CapCut), Fotografi<br>
                    ‚Ä¢ Google Workspace, Social Media Management
                </div>
            </div>

            <!-- Skill Non-Teknis -->
            <div class="section">
                <h2><span class="icon">ü§ù</span> Skill Non-Teknis (Soft Skills)</h2>
                
                <div id="skill-nonteknis-container">
                    <div class="skill-item">
                        <label>Nama Skill Non-Teknis:</label>
                        <input type="text" placeholder="Contoh: Public Speaking, Leadership, dll">
                        <label>Tingkat Kemampuan:</label>
                        <select>
                            <option value="">Pilih tingkat kemampuan</option>
                            <option value="Dasar">Dasar</option>
                            <option value="Menengah">Menengah</option>
                            <option value="Mahir">Mahir</option>
                            <option value="Expert">Expert</option>
                        </select>
                        <label>Pengalaman/Contoh:</label>
                        <textarea placeholder="Ceritakan pengalaman yang menunjukkan skill ini..." rows="2"></textarea>
                    </div>
                </div>
                <button type="button" onclick="addSkillNonTeknis()" style="background: #9b59b6; color: white; padding: 10px 20px; border: none; border-radius: 5px; margin-top: 10px;">+ Tambah Skill Non-Teknis</button>
                
                <div class="tips">
                    <h4>üí° Contoh Skill Non-Teknis:</h4>
                    ‚Ä¢ Kepemimpinan (memimpin tim OSIS, koordinator acara)<br>
                    ‚Ä¢ Komunikasi (MC, presentasi, negosiasi)<br>
                    ‚Ä¢ Public Speaking (pidato, moderator diskusi)<br>
                    ‚Ä¢ Problem Solving (menyelesaikan konflik, troubleshooting)<br>
                    ‚Ä¢ Manajemen Waktu, Kreativitas, Adaptasi, Kerja Tim
                </div>
            </div>

            <!-- Informasi Tambahan -->
            <div class="section">
                <h2><span class="icon">üèÖ</span> Informasi Tambahan</h2>
                
                <div class="form-group">
                    <label for="prestasi">Prestasi & Penghargaan</label>
                    <textarea id="prestasi" name="prestasi" placeholder="Sebutkan prestasi akademik maupun non-akademik yang pernah diraih..." rows="4"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="hobi">Minat & Hobi</label>
                    <textarea id="hobi" name="hobi" placeholder="Sebutkan hobi dan minat yang menunjukkan kepribadian Anda..." rows="3"></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="bahasa">Kemampuan Bahasa</label>
                        <textarea id="bahasa" name="bahasa" placeholder="Contoh: Indonesia (Native), Inggris (Menengah), Jawa (Aktif)" rows="2"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="nilai">Rata-rata Nilai/IPK</label>
                        <input type="text" id="nilai" name="nilai" placeholder="Contoh: 85,5">
                    </div>
                </div>
            </div>

            <div class="btn-container">
                <button type="button" class="btn" onclick="generateCV()">
                    üì• Download CV Saya (.md)
                </button>
                <p style="margin-top: 15px; color: #666; font-size: 14px;">
                    <em>CV akan didownload dalam format Markdown (.md) yang dapat dibuka dengan editor teks atau viewer Markdown</em>
                </p>
            </div>
        </div>
    </div>

    <script>
        function selectLevel(button, skillId = null) {
            // Remove active class from siblings
            const siblings = button.parentElement.querySelectorAll('.level-option');
            siblings.forEach(sibling => sibling.classList.remove('active'));
            
            // Add active class to clicked button
            button.classList.add('active');
            
            // Save level to hidden input if skillId is provided
            if (skillId) {
                const levelInput = document.getElementById(skillId + '_level');
                if (levelInput) {
                    levelInput.value = button.textContent;
                    saveSkillData(skillId);
                }
            }
        }

        function saveSkillData(skillId) {
            const nameInput = document.getElementById(skillId + '_name');
            const levelInput = document.getElementById(skillId + '_level');
            
            if (nameInput && levelInput) {
                const skillData = {
                    name: nameInput.value,
                    level: levelInput.value
                };
                localStorage.setItem(skillId, JSON.stringify(skillData));
            }
        }

        function removeSkill(button, skillId) {
            // Remove from localStorage
            localStorage.removeItem(skillId);
            
            // Remove from DOM
            button.parentElement.remove();
        }

        function loadSkillData(skillId) {
            const savedData = localStorage.getItem(skillId);
            if (savedData) {
                const skillData = JSON.parse(savedData);
                
                const nameInput = document.getElementById(skillId + '_name');
                const levelInput = document.getElementById(skillId + '_level');
                
                if (nameInput && levelInput) {
                    nameInput.value = skillData.name || '';
                    levelInput.value = skillData.level || '';
                    
                    // Set active level button
                    if (skillData.level) {
                        const levelButtons = nameInput.parentElement.querySelectorAll('.level-option');
                        levelButtons.forEach(btn => {
                            if (btn.textContent === skillData.level) {
                                btn.classList.add('active');
                            }
                        });
                    }
                }
            }
        }

        function addSkillTeknis() {
            const container = document.getElementById('skill-teknis-container');
            const skillItem = document.createElement('div');
            skillItem.className = 'skill-item';
            skillItem.innerHTML = `
                <label>Nama Skill Teknis:</label>
                <input type="text" placeholder="Contoh: Microsoft Office, Photoshop, Python, dll">
                <label>Tingkat Kemampuan:</label>
                <select>
                    <option value="">Pilih tingkat kemampuan</option>
                    <option value="Dasar">Dasar</option>
                    <option value="Menengah">Menengah</option>
                    <option value="Mahir">Mahir</option>
                    <option value="Expert">Expert</option>
                </select>
                <label>Deskripsi/Pengalaman:</label>
                <textarea placeholder="Jelaskan pengalaman menggunakan skill ini..." rows="2"></textarea>
                <button type="button" onclick="this.parentElement.remove()" style="background: #e74c3c; color: white; padding: 4px 8px; border: none; border-radius: 3px; margin-top: 5px; font-size: 12px;">Hapus</button>
            `;
            container.appendChild(skillItem);
        }

        function addSkillNonTeknis() {
            const container = document.getElementById('skill-nonteknis-container');
            const skillItem = document.createElement('div');
            skillItem.className = 'skill-item';
            skillItem.innerHTML = `
                <label>Nama Skill Non-Teknis:</label>
                <input type="text" placeholder="Contoh: Public Speaking, Leadership, dll">
                <label>Tingkat Kemampuan:</label>
                <select>
                    <option value="">Pilih tingkat kemampuan</option>
                    <option value="Dasar">Dasar</option>
                    <option value="Menengah">Menengah</option>
                    <option value="Mahir">Mahir</option>
                    <option value="Expert">Expert</option>
                </select>
                <label>Pengalaman/Contoh:</label>
                <textarea placeholder="Ceritakan pengalaman yang menunjukkan skill ini..." rows="2"></textarea>
                <button type="button" onclick="this.parentElement.remove()" style="background: #e74c3c; color: white; padding: 4px 8px; border: none; border-radius: 3px; margin-top: 5px; font-size: 12px;">Hapus</button>
            `;
            container.appendChild(skillItem);
        }

        function addOrganisasi() {
            const container = document.getElementById('organisasi-container');
            const orgItem = document.createElement('div');
            orgItem.className = 'skill-item';
            orgItem.innerHTML = `
                <label>Nama Organisasi/Ekstrakurikuler:</label>
                <input type="text" placeholder="Contoh: OSIS, PMR, Pramuka, Rohis, dll">
                <label>Posisi/Jabatan:</label>
                <input type="text" placeholder="Contoh: Sekretaris, Anggota, Ketua Seksi, dll">
                <label>Periode:</label>
                <input type="text" placeholder="Contoh: 2023 - Sekarang">
                <label>Deskripsi Kegiatan:</label>
                <textarea placeholder="Jelaskan tugas dan pencapaian Anda..." rows="3"></textarea>
                <button type="button" onclick="this.parentElement.remove()" style="background: #e74c3c; color: white; padding: 4px 8px; border: none; border-radius: 3px; margin-top: 5px; font-size: 12px;">Hapus</button>
            `;
            container.appendChild(orgItem);
        }

        function generateCV() {
            // Collect all form data
            const formData = {
                nama: document.getElementById('nama').value,
                about: document.getElementById('about').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                kota: document.getElementById('kota').value,
                sekolah: document.getElementById('sekolah').value,
                prestasi: document.getElementById('prestasi').value,
                hobi: document.getElementById('hobi').value,
                bahasa: document.getElementById('bahasa').value,
                nilai: document.getElementById('nilai').value
            };

            // Collect skills data
            formData.skillTeknis = collectSkillsData('teknis');
            formData.skillNonTeknis = collectSkillsData('nonteknis');
            
            // Collect organization data
            formData.organisasi = collectOrganisasiData();

            // Check required fields
            if (!formData.nama || !formData.about || !formData.email) {
                alert('‚ö†Ô∏è Mohon lengkapi data wajib: Nama, About Me, dan Email!');
                return;
            }

            // Generate Markdown content
            const markdownContent = generateMarkdownCV(formData);
            
            // Create and download file
            downloadMarkdownFile(markdownContent, formData.nama || 'CV_Siswa_SMA');

            // Show success message with summary
            let skillSummary = '';
            if (formData.skillTeknis.length > 0) {
                skillSummary += `\n‚úÖ Skill Teknis: ${formData.skillTeknis.length} skill`;
            }
            if (formData.skillNonTeknis.length > 0) {
                skillSummary += `\n‚úÖ Skill Non-Teknis: ${formData.skillNonTeknis.length} skill`;
            }
            if (formData.organisasi.length > 0) {
                skillSummary += `\n‚úÖ Pengalaman Organisasi: ${formData.organisasi.length} organisasi`;
            }

            alert(`‚úÖ CV berhasil dibuat dan didownload! \n\nRingkasan Data:${skillSummary}\n\nFile CV_${formData.nama.replace(/\s+/g, '_')}.md telah didownload ke perangkat Anda.`);
        }

        function generateMarkdownCV(data) {
            const today = new Date().toLocaleDateString('id-ID', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });

            let markdown = `# **CURRICULUM VITAE**

---

## **üìã DATA PRIBADI**

**Nama Lengkap:** ${data.nama}  
**Email:** ${data.email}${data.phone ? `\n**No. HP/WhatsApp:** ${data.phone}` : ''}${data.kota ? `\n**Kota/Kabupaten:** ${data.kota}` : ''}${data.sekolah ? `\n**Sekolah:** ${data.sekolah}` : ''}${data.nilai ? `\n**Rata-rata Nilai:** ${data.nilai}` : ''}

---

## **üí´ ABOUT ME**

${data.about || 'Belum diisi'}

---
`;

            // Add Skills sections
            if (data.skillTeknis.length > 0) {
                markdown += `## **üíª SKILL TEKNIS**

`;
                data.skillTeknis.forEach((skill, index) => {
                    markdown += `**${index + 1}. ${skill.nama}**`;
                    if (skill.tingkat) {
                        markdown += ` - *Tingkat: ${skill.tingkat}*`;
                    }
                    markdown += '\n';
                    if (skill.deskripsi) {
                        markdown += `   ${skill.deskripsi}\n`;
                    }
                    markdown += '\n';
                });
                markdown += '---\n\n';
            }

            if (data.skillNonTeknis.length > 0) {
                markdown += `## **ü§ù SKILL NON-TEKNIS**

`;
                data.skillNonTeknis.forEach((skill, index) => {
                    markdown += `**${index + 1}. ${skill.nama}**`;
                    if (skill.tingkat) {
                        markdown += ` - *Tingkat: ${skill.tingkat}*`;
                    }
                    markdown += '\n';
                    if (skill.deskripsi) {
                        markdown += `   ${skill.deskripsi}\n`;
                    }
                    markdown += '\n';
                });
                markdown += '---\n\n';
            }

            // Add Organization experience
            if (data.organisasi.length > 0) {
                markdown += `## **üèÜ PENGALAMAN ORGANISASI**

`;
                data.organisasi.forEach((org, index) => {
                    markdown += `### **${index + 1}. ${org.nama}**\n`;
                    if (org.posisi) {
                        markdown += `*Posisi:* **${org.posisi}**\n`;
                    }
                    if (org.periode) {
                        markdown += `*Periode:* ${org.periode}\n`;
                    }
                    if (org.deskripsi) {
                        markdown += `\n${org.deskripsi}\n`;
                    }
                    markdown += '\n';
                });
                markdown += '---\n\n';
            }

            // Add additional information
            let hasAdditionalInfo = false;
            let additionalSection = `## **üåü INFORMASI TAMBAHAN**

`;

            if (data.prestasi) {
                additionalSection += `### **üèÖ Prestasi & Penghargaan**
${data.prestasi}

`;
                hasAdditionalInfo = true;
            }

            if (data.hobi) {
                additionalSection += `### **üé® Minat & Hobi**
${data.hobi}

`;
                hasAdditionalInfo = true;
            }

            if (data.bahasa) {
                additionalSection += `### **üó£Ô∏è Kemampuan Bahasa**
${data.bahasa}

`;
                hasAdditionalInfo = true;
            }

            if (hasAdditionalInfo) {
                markdown += additionalSection + '---\n\n';
            }

            // Footer
            markdown += `---

*CV ini dibuat menggunakan Form CV Siswa SMA*  
*Tanggal pembuatan: ${today}*

---

> **üí° Tips untuk penggunaan CV:**
> - Sesuaikan dengan kebutuhan aplikasi beasiswa/magang
> - Update secara berkala dengan pencapaian terbaru
> - Gunakan bahasa yang profesional namun sesuai usia
> - Sertakan portofolio atau bukti pencapaian jika ada`;

            return markdown;
        }

        function downloadMarkdownFile(content, fileName) {
            // Clean filename
            const cleanFileName = fileName.replace(/[^a-zA-Z0-9]/g, '_');
            
            // Create blob
            const blob = new Blob([content], { type: 'text/markdown;charset=utf-8' });
            
            // Create download link
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `CV_${cleanFileName}.md`;
            
            // Trigger download
            document.body.appendChild(link);
            link.click();
            
            // Cleanup
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        function collectSkillsData(type) {
            const skills = [];
            let container;
            
            if (type === 'teknis') {
                container = document.getElementById('skill-teknis-container');
            } else {
                container = document.getElementById('skill-nonteknis-container');
            }
            
            const skillItems = container.querySelectorAll('.skill-item');
            
            skillItems.forEach(item => {
                const inputs = item.querySelectorAll('input, select, textarea');
                if (inputs.length >= 3) {
                    const namaSkill = inputs[0].value.trim();
                    if (namaSkill) {
                        skills.push({
                            nama: namaSkill,
                            tingkat: inputs[1].value,
                            deskripsi: inputs[2].value.trim()
                        });
                    }
                }
            });
            
            return skills;
        }

        function collectOrganisasiData() {
            const organisasi = [];
            const container = document.getElementById('organisasi-container');
            const orgItems = container.querySelectorAll('.skill-item');
            
            orgItems.forEach(item => {
                const inputs = item.querySelectorAll('input, textarea');
                if (inputs.length >= 4) {
                    const namaOrg = inputs[0].value.trim();
                    if (namaOrg) {
                        organisasi.push({
                            nama: namaOrg,
                            posisi: inputs[1].value.trim(),
                            periode: inputs[2].value.trim(),
                            deskripsi: inputs[3].value.trim()
                        });
                    }
                }
            });
            
            return organisasi;
        }

        // Add some interactive enhancements
        document.addEventListener('DOMContentLoaded', function() {
            // Auto-save to localStorage for all inputs
            const inputs = document.querySelectorAll('input:not([type="hidden"]), textarea, select');
            inputs.forEach(input => {
                input.addEventListener('input', function() {
                    if (this.id) {
                        localStorage.setItem('cv_' + this.id, this.value);
                    }
                });
                
                // Load saved data
                if (input.id) {
                    const savedValue = localStorage.getItem('cv_' + input.id);
                    if (savedValue) {
                        input.value = savedValue;
                    }
                }
            });
            
            // Add welcome message
            console.log('üéØ Form CV Siswa SMA siap digunakan!');
            console.log('üíæ Data akan tersimpan otomatis saat Anda mengetik');
        });
    </script>
</body>
</html>